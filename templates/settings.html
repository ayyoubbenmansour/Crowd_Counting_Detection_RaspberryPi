{% extends "layout.html" %}

{% block content %}
<div class="max-w-3xl mx-auto">
    <!-- Header -->
    <div class="mb-8 border-b border-gray-800 pb-5">
        <h1 class="text-3xl font-bold text-white mb-2">
            <i class="fa-solid fa-sliders mr-3 text-orange-500"></i>Settings
        </h1>
        <p class="text-gray-400">Configure the Crowd Counting System parameters.</p>
    </div>

    <!-- Alert Success -->
    {% if success %}
    <div class="bg-green-500/10 border border-green-500 text-green-500 px-4 py-3 rounded mb-6 flex items-center"
        role="alert">
        <i class="fa-solid fa-circle-check mr-2"></i>
        <span>Settings updated successfully! The zone has been resized.</span>
    </div>
    {% endif %}

    <!-- Zone Configuration Card -->
    <div class="bg-gray-800 rounded-lg shadow-lg overflow-hidden border border-gray-700 mb-6">
        <div class="px-6 py-4 border-b border-gray-700 bg-gray-900/50">
            <h3 class="text-xl font-semibold text-white flex items-center">
                <i class="fa-solid fa-vector-square mr-2 text-indigo-400"></i> Detection Zone Size
            </h3>
        </div>

        <div class="p-6">
            <form method="POST" action="/settings">
                <div class="mb-6">
                    <label for="zone_percentage" class="block text-sm font-medium text-gray-300 mb-2">
                        Zone Coverage Percentage
                    </label>
                    <div class="flex items-center space-x-4">
                        <input type="range" id="zone_percentage" name="zone_percentage" min="0.3" max="1.0" step="0.05"
                            value="{{ percentage }}"
                            class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-orange-500"
                            oninput="updateOutput(this.value)">
                        <span class="text-xl font-bold text-orange-500 font-mono w-16 text-right">
                            <span id="percentage_output">{{ (percentage * 100)|int }}</span>%
                        </span>
                    </div>
                </div>

                <div class="mb-6 border-t border-gray-700 pt-6">
                    <label for="alert_threshold" class="block text-sm font-medium text-gray-300 mb-2">
                        Crowd Alert Threshold
                    </label>
                    <div class="flex items-center space-x-4">
                        <input type="number" id="alert_threshold" name="alert_threshold" min="1" max="100"
                            value="{{ threshold }}"
                            class="bg-gray-700 text-white rounded-lg px-4 py-2 w-24 border border-gray-600 focus:outline-none focus:border-orange-500">
                        <p class="text-sm text-gray-500">
                            Trigger an alert when occupancy reaches this number.
                        </p>
                    </div>
                </div>

                <div class="flex justify-end">
                    <button type="submit"
                        class="bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 px-6 rounded transition duration-200 flex items-center shadow-lg hover:shadow-orange-500/20">
                        <i class="fa-solid fa-save mr-2"></i> Save Changes
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Info Card -->
    <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="bg-gray-900 border border-gray-800 rounded-lg p-5">
            <h4 class="text-orange-500 font-semibold mb-2"><i class="fa-solid fa-lightbulb mr-2"></i>Tip</h4>
            <p class="text-sm text-gray-400">
                A "Zone Percentage" of <strong>85-90%</strong> is usually best. It leaves a small margin around the
                edges so people can fully enter the frame before being counted.
            </p>
        </div>
        <div class="bg-gray-900 border border-gray-800 rounded-lg p-5">
            <h4 class="text-blue-500 font-semibold mb-2"><i class="fa-solid fa-info-circle mr-2"></i>Note</h4>
            <p class="text-sm text-gray-400">
                Updating the zone size happens instantly. Current resolution is set to standard
                <strong>640x480</strong>.
            </p>
        </div>
    </div>
</div>

<script>
    function updateOutput(val) {
        document.getElementById('percentage_output').innerText = Math.round(val * 100);
    }
</script>
{% endblock %}